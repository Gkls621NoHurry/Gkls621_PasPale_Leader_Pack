-- Aya Traits
CREATE TEMP TABLE GklsAyaTechs(
    TechnologyType	TEXT
					DEFAULT NULL
);

INSERT INTO GklsAyaTechs
(TechnologyType)VALUES
('TECH_CONSTRUCTION'),
('TECH_ENGINEERING'),
('TECH_MACHINERY'),
('TECH_APPENTICESHIP'),
('TECH_MILITARY_ENGINEERING'),
('TECH_REFINING');
--('TECH_MASS_PRODUCTION'),
--('TECH_REPLACEABLE_PARTS'),
--('TECH_COMBUSTION');

INSERT INTO Types
(Type,  Kind)
VALUES
('TRAIT_LEADER_AYA_gkls621', 'KIND_TRAIT');

INSERT INTO Traits
(TraitType,                     Name,                                   Description)
VALUES
('TRAIT_LEADER_AYA_gkls621', 'LOC_TRAIT_LEADER_AYA_gkls621_NAME', 'LOC_TRAIT_LEADER_AYA_gkls621_DESCRIPTION');

INSERT INTO LeaderTraits
(LeaderType,                TraitType)
VALUES
('LEADER_AYA_gkls621',   'TRAIT_LEADER_AYA_gkls621'),
('LEADER_AYA_gkls621',   'TRAIT_DISTRICT_GARAGE_gkls621');

INSERT INTO TraitModifiers
(TraitType, ModifierId)
VALUES
--('TRAIT_LEADER_AYA_gkls621',    'AYA_EXTRA_ERA_SCORE_BASE_gkls621'),
--('TRAIT_LEADER_AYA_gkls621',    'AYA_EXTRA_ERA_SCORE_DARK_AGE_gkls621'),
('TRAIT_LEADER_AYA_gkls621',    'AYA_CITIES_WORKSHOP_GRANT_BUILDER_gkls621'),
('TRAIT_LEADER_AYA_gkls621',    'AYA_CITIES_FACTORY_GRANT_BUILDER_gkls621'),
('TRAIT_LEADER_AYA_gkls621',    'AYA_CITIES_FACTORY_GRANT_ENGINEER_gkls621'),
('TRAIT_LEADER_AYA_gkls621',    'AYA_CULTURE_FROM_EARNED_GREAT_PEOPLE_gkls621'),
('TRAIT_LEADER_AYA_gkls621',    'AYA_SCIENCE_FROM_EARNED_GREAT_PEOPLE_gkls621'),
('TRAIT_LEADER_AYA_gkls621',    'AYA_FAITH_FROM_EARNED_GREAT_PEOPLE_gkls621'),
('TRAIT_LEADER_AYA_gkls621',    'AYA_UNITS_ADJUST_BUILD_CHARGE_gkls621'),
('TRAIT_LEADER_AYA_gkls621',    'AYA_AI_DISABLE_SPY_PROMISE_gkls621');

INSERT INTO TraitModifiers
(TraitType, ModifierId)
SELECT
'TRAIT_LEADER_AYA_gkls621', 'AYA_GRANT_' || SUBSTR(TechnologyType,6) || '_BOOST_gkls621'
FROM GklsAyaTechs;

INSERT INTO TraitModifiers
(TraitType, ModifierId)
SELECT DISTINCT
'TRAIT_LEADER_AYA_gkls621', 'AYA_ADJUST_' || UnitType || '_PURCHASE_COST_gkls621'
FROM Units WHERE PromotionClass = 'PROMOTION_CLASS_HEAVY_CAVALRY' AND TraitType IS NULL;

INSERT INTO GovernorPromotionModifiers
(GovernorPromotionType, ModifierId)
SELECT
GovernorPromotionType,  'AYA_PREVENT_DISASTER_DAMAGE_gkls621'
FROM GovernorPromotions WHERE BaseAbility = 1;

INSERT INTO Modifiers
(ModifierId,    ModifierType,   Permanent,    SubjectRequirementSetId)
VALUES
('AYA_CITIES_WORKSHOP_GRANT_BUILDER_gkls621',   'MODIFIER_PLAYER_CITIES_GRANT_UNIT_IN_CITY',    1,  'REQSET_PASPALE_CITY_HAS_WORKSHOP_gkls621'),
('AYA_CITIES_FACTORY_GRANT_BUILDER_gkls621',   'MODIFIER_PLAYER_CITIES_GRANT_UNIT_IN_CITY',    1,  'REQSET_PASPALE_CITY_HAS_FACTORY_gkls621'),
('AYA_CITIES_FACTORY_GRANT_ENGINEER_gkls621',   'MODIFIER_PLAYER_CITIES_GRANT_UNIT_IN_CITY',    1,  'REQSET_PASPALE_CITY_HAS_FACTORY_gkls621');

INSERT INTO Modifiers
(ModifierId,    ModifierType,   SubjectRequirementSetId)
VALUES
--('AYA_EXTRA_ERA_SCORE_BASE_gkls621',                'MODIFIER_PLAYER_ADJUST_PLAYER_ERA_SCORE_PER_PRIDE_MOMENT',         NULL),
--('AYA_EXTRA_ERA_SCORE_DARK_AGE_gkls621',            'MODIFIER_PLAYER_ADJUST_PLAYER_ERA_SCORE_PER_PRIDE_MOMENT',         'PLAYER_HAS_DARK_AGE'),
('AYA_CULTURE_FROM_EARNED_GREAT_PEOPLE_gkls621',    'MODIFIER_PLAYER_ADJUST_YIELD_MODIFIER_PER_EARNED_GREAT_PERSON',    NULL),
('AYA_SCIENCE_FROM_EARNED_GREAT_PEOPLE_gkls621',    'MODIFIER_PLAYER_ADJUST_YIELD_MODIFIER_PER_EARNED_GREAT_PERSON',    NULL),
('AYA_FAITH_FROM_EARNED_GREAT_PEOPLE_gkls621',      'MODIFIER_PLAYER_ADJUST_YIELD_MODIFIER_PER_EARNED_GREAT_PERSON',    NULL),
('AYA_PREVENT_DISASTER_DAMAGE_gkls621',             'MODIFIER_GOVERNOR_ADJUST_PREVENET_STRUCTURAL_DAMAGE',              'REQSET_PASPALE_PLAYER_IS_AYA_gkls621'),
('AYA_UNITS_ADJUST_BUILD_CHARGE_gkls621',           'MODIFIER_PLAYER_TRAINED_UNITS_ADJUST_BUILDER_CHARGES',             'REQSET_PASPALE_AYA_CHARGE_UNITS_gkls621'),
('AYA_AI_DISABLE_SPY_PROMISE_gkls621',              'MODIFIER_PLAYER_ADJUST_BANNED_DIPLOMATIC_ACTION',                  'PLAYER_IS_AI');

INSERT INTO Modifiers
(ModifierId,    ModifierType,   RunOnce,    Permanent)
SELECT
'AYA_GRANT_' || SUBSTR(TechnologyType,6) || '_BOOST_gkls621',
'MODIFIER_PLAYER_GRANT_SPECIFIC_TECH_BOOST',    1,  1
FROM GklsAyaTechs;

INSERT INTO Modifiers
(ModifierId,    ModifierType, SubjectRequirementSetId)
SELECT
'AYA_ADJUST_' || UnitType || '_PURCHASE_COST_gkls621',
'MODIFIER_PLAYER_CITIES_ADJUST_UNIT_PURCHASE_COST',
'PLAYER_IS_HUMAN'
FROM Units WHERE PromotionClass = 'PROMOTION_CLASS_HEAVY_CAVALRY' AND TraitType IS NULL;

INSERT INTO ModifierArguments
(ModifierId,    Name,   Value)
VALUES
--('AYA_EXTRA_ERA_SCORE_BASE_gkls621',    'Amount',   1),
--('AYA_EXTRA_ERA_SCORE_BASE_gkls621',    'MinScore',   2),
--('AYA_EXTRA_ERA_SCORE_DARK_AGE_gkls621',    'Amount',   1),
--('AYA_EXTRA_ERA_SCORE_DARK_AGE_gkls621',    'MinScore',   1),
('AYA_CITIES_WORKSHOP_GRANT_BUILDER_gkls621', 'AllowUniqueOverride', 0),
('AYA_CITIES_WORKSHOP_GRANT_BUILDER_gkls621', 'Amount', 1),
('AYA_CITIES_WORKSHOP_GRANT_BUILDER_gkls621', 'UnitType', 'UNIT_BUILDER'),
('AYA_CITIES_FACTORY_GRANT_BUILDER_gkls621', 'AllowUniqueOverride', 0),
('AYA_CITIES_FACTORY_GRANT_BUILDER_gkls621', 'Amount', 1),
('AYA_CITIES_FACTORY_GRANT_BUILDER_gkls621', 'UnitType', 'UNIT_BUILDER'),
('AYA_CITIES_FACTORY_GRANT_ENGINEER_gkls621', 'AllowUniqueOverride', 0),
('AYA_CITIES_FACTORY_GRANT_ENGINEER_gkls621', 'Amount', 1),
('AYA_CITIES_FACTORY_GRANT_ENGINEER_gkls621', 'UnitType', 'UNIT_MILITARY_ENGINEER'),
('AYA_CULTURE_FROM_EARNED_GREAT_PEOPLE_gkls621',    'Amount',   5),
('AYA_CULTURE_FROM_EARNED_GREAT_PEOPLE_gkls621',    'YieldType',   'YIELD_CULTURE'),
('AYA_SCIENCE_FROM_EARNED_GREAT_PEOPLE_gkls621',    'Amount',   5),
('AYA_SCIENCE_FROM_EARNED_GREAT_PEOPLE_gkls621',    'YieldType',   'YIELD_SCIENCE'),
('AYA_FAITH_FROM_EARNED_GREAT_PEOPLE_gkls621',    'Amount',   5),
('AYA_FAITH_FROM_EARNED_GREAT_PEOPLE_gkls621',    'YieldType',   'YIELD_FAITH'),
('AYA_PREVENT_DISASTER_DAMAGE_gkls621', 'Prevent',  1),
('AYA_UNITS_ADJUST_BUILD_CHARGE_gkls621',   'Amount',   1),
('AYA_AI_DISABLE_SPY_PROMISE_gkls621',  'DiplomaticActionType', 'DIPLOACTION_KEEP_PROMISE_DONT_SPY'),
('AYA_AI_DISABLE_SPY_PROMISE_gkls621',  'Banned',  1);

INSERT INTO ModifierArguments
(ModifierId,    Name,   Value)
SELECT
'AYA_GRANT_' || SUBSTR(TechnologyType,6) || '_BOOST_gkls621',
'TechType', TechnologyType
FROM GklsAyaTechs;

INSERT INTO ModifierArguments
(ModifierId,    Name,   Value)
SELECT
'AYA_ADJUST_' || UnitType || '_PURCHASE_COST_gkls621',
'Amount', 50
FROM Units WHERE PromotionClass = 'PROMOTION_CLASS_HEAVY_CAVALRY' AND TraitType IS NULL;

INSERT INTO ModifierArguments
(ModifierId,    Name,   Value)
SELECT
'AYA_ADJUST_' || UnitType || '_PURCHASE_COST_gkls621',
'UnitType', UnitType
FROM Units WHERE PromotionClass = 'PROMOTION_CLASS_HEAVY_CAVALRY' AND TraitType IS NULL;

INSERT INTO RequirementSets
(RequirementSetId,  RequirementSetType)
VALUES
('REQSET_PASPALE_CITY_HAS_WORKSHOP_gkls621',  'REQUIREMENTSET_TEST_ANY'),
('REQSET_PASPALE_CITY_HAS_FACTORY_gkls621',  'REQUIREMENTSET_TEST_ANY'),
('REQSET_PASPALE_PLAYER_IS_AYA_gkls621',    'REQUIREMENTSET_TEST_ALL'),
('REQSET_PASPALE_AYA_CHARGE_UNITS_gkls621',    'REQUIREMENTSET_TEST_ANY');

INSERT INTO RequirementSetRequirements
(RequirementSetId,  RequirementId)
VALUES
('REQSET_PASPALE_PLAYER_IS_AYA_gkls621',  'PASPALE_PLAYER_IS_AYA_gkls621'),
('REQSET_PASPALE_AYA_CHARGE_UNITS_gkls621',   'REQUIREMENT_UNIT_IS_MILITARY_ENGINEER'),
('REQSET_PASPALE_AYA_CHARGE_UNITS_gkls621',    'REQUIREMENT_UNIT_IS_BUILDER'),
('REQSET_PASPALE_AYA_CHARGE_UNITS_gkls621',    'REQUIREMENT_UNIT_IS_MELEE'),
('REQSET_PASPALE_AYA_CHARGE_UNITS_gkls621',    'REQUIREMENT_UNIT_IS_ANTI_CAV'),
('REQSET_PASPALE_AYA_CHARGE_UNITS_gkls621',    'REQUIREMENT_UNIT_IS_LIGHT_CAV'),
('REQSET_PASPALE_AYA_CHARGE_UNITS_gkls621',    'UNIT_IS_HEAVY_CAVALRY'),
('REQSET_PASPALE_AYA_CHARGE_UNITS_gkls621',    'PASPALE_UNIT_IS_FANS_gkls621');

INSERT INTO Requirements (RequirementId, RequirementType)
VALUES
('PASPALE_PLAYER_IS_AYA_gkls621', 'REQUIREMENT_PLAYER_LEADER_TYPE_MATCHES'),
('PASPALE_UNIT_IS_FANS_gkls621', 'REQUIREMENT_UNIT_TYPE_MATCHES');

INSERT INTO RequirementArguments (RequirementId, Name, Value)
VALUES
('PASPALE_PLAYER_IS_AYA_gkls621', 'LeaderType', 'LEADER_AYA_gkls621'),
('PASPALE_UNIT_IS_FANS_gkls621', 'UnitType', 'UNIT_FANS_gkls621');

-- Tier1 Industry Buildings
INSERT INTO RequirementSetRequirements
(RequirementSetId,  RequirementId)
SELECT DISTINCT
'REQSET_PASPALE_CITY_HAS_WORKSHOP_gkls621',
'PASPALE_CITY_HAS_' || SUBSTR(b1.BuildingType, 10) || '_gkls621'
FROM Buildings b1
WHERE b1.PrereqDistrict = 'DISTRICT_INDUSTRIAL_ZONE'
AND NOT EXISTS (
    SELECT 1
    FROM BuildingPrereqs b2
    WHERE b2.Building = b1.BuildingType
);

INSERT INTO Requirements
(RequirementId, RequirementType)
SELECT DISTINCT
'PASPALE_CITY_HAS_' || SUBSTR(b1.BuildingType, 10) || '_gkls621',
'REQUIREMENT_CITY_HAS_BUILDING'
FROM Buildings b1
WHERE b1.PrereqDistrict = 'DISTRICT_INDUSTRIAL_ZONE'
AND NOT EXISTS (
    SELECT 1
    FROM BuildingPrereqs b2
    WHERE b2.Building = b1.BuildingType
);

INSERT INTO RequirementArguments
(RequirementId, Name,   Value)
SELECT DISTINCT
'PASPALE_CITY_HAS_' || SUBSTR(b1.BuildingType, 10) || '_gkls621',
'BuildingType', b1.BuildingType
FROM Buildings b1
WHERE b1.PrereqDistrict = 'DISTRICT_INDUSTRIAL_ZONE'
AND NOT EXISTS (
    SELECT 1
    FROM BuildingPrereqs b2
    WHERE b2.Building = b1.BuildingType
);
-- Tier2 Industry Buildings
INSERT INTO RequirementSetRequirements
(RequirementSetId,  RequirementId)
SELECT DISTINCT
'REQSET_PASPALE_CITY_HAS_FACTORY_gkls621',
'PASPALE_CITY_HAS_' || SUBSTR(b1.BuildingType, 10) || '_gkls621'
FROM Buildings b1
WHERE b1.PrereqDistrict = 'DISTRICT_INDUSTRIAL_ZONE'
AND EXISTS (
    SELECT 1
    FROM BuildingPrereqs b2
    WHERE b2.Building = b1.BuildingType AND b2.PrereqBuilding = 'BUILDING_WORKSHOP'
);

INSERT INTO Requirements
(RequirementId, RequirementType)
SELECT DISTINCT
'PASPALE_CITY_HAS_' || SUBSTR(b1.BuildingType, 10) || '_gkls621',
'REQUIREMENT_CITY_HAS_BUILDING'
FROM Buildings b1
WHERE b1.PrereqDistrict = 'DISTRICT_INDUSTRIAL_ZONE'
AND EXISTS (
    SELECT 1
    FROM BuildingPrereqs b2
    WHERE b2.Building = b1.BuildingType AND b2.PrereqBuilding = 'BUILDING_WORKSHOP'
);

INSERT INTO RequirementArguments
(RequirementId, Name,   Value)
SELECT DISTINCT
'PASPALE_CITY_HAS_' || SUBSTR(b1.BuildingType, 10) || '_gkls621',
'BuildingType', b1.BuildingType
FROM Buildings b1
WHERE b1.PrereqDistrict = 'DISTRICT_INDUSTRIAL_ZONE'
AND EXISTS (
    SELECT 1
    FROM BuildingPrereqs b2
    WHERE b2.Building = b1.BuildingType AND b2.PrereqBuilding = 'BUILDING_WORKSHOP'
);